{% extends 'base.html' %}
{% load static %}

{% block body %}
<style>
  .form-container {
    max-width: 400px;
    margin: 120px auto;
    background: #fff;
    padding: 40px 50px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }
</style>

<div class="form-container">
  <h2 style="text-align: center; margin-bottom: 20px;">Set New Password</h2>

  {% if validlink %}
    <form method="post">
      {% csrf_token %}

      <div style="margin-bottom: 15px;">
        <label for="id_new_password1">New Password:</label>
        <input type="password" name="new_password1" id="id_new_password1" required style="width: 100%; padding: 8px; margin-top: 5px;">
        {% if form.new_password1.errors %}
          <div style="color: red; font-size: 12px;">{{ form.new_password1.errors }}</div>
        {% endif %}
      </div>

      <div style="margin-bottom: 15px;">
        <label for="id_new_password2">Confirm New Password:</label>
        <input type="password" name="new_password2" id="id_new_password2" required style="width: 100%; padding: 8px; margin-top: 5px;">
        {% if form.new_password2.errors %}
          <div style="color: red; font-size: 12px;">{{ form.new_password2.errors }}</div>
        {% endif %}
      </div>

      <button type="submit" style="width: 100%; padding: 10px; background: #ff6b6b; color: white; border: none; border-radius: 5px; cursor: pointer;">
        Change Password
      </button>
    </form>
  {% else %}
    <p style="text-align: center; color: #ff5252;">
      The password reset link was invalid, possibly because it has already been used.
      Please request a new password reset.
    </p>
    <a href="{% url 'password_reset' %}" style="display: block; text-align: center; margin-top: 15px;">
      Request New Reset Link
    </a>
  {% endif %}
</div>

<!-- Debug info -->
<script>
console.log("Password reset confirm page loaded");
console.log("Valid link: {{ validlink }}");
</script>
{% endblock %}