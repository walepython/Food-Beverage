{% extends 'base.html' %}
{% load static %}
{% block body %}
<link rel="stylesheet" href="{% static 'assets/css/auth_forms.css' %}">
<!-- Your main login form container -->
<div class="login-container">
    <form method="post">
        <h2>Login</h2>
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Login</button>

        <!-- Link to trigger the modal -->
        <div class="forgot-password-link">
            <a href="#" id="forgot-password-trigger">Forgot Password?</a>
        </div>
    </form>
</div>


<!-- =============================== -->
<!-- === PASSWORD RESET MODAL markup === -->
<!-- =============================== -->
<div class="modal-overlay" id="reset-password-modal-overlay">
    <div class="modal-content" id="reset-password-modal">

        <button class="modal-close" id="modal-close-btn">&times;</button>

        <h2>Reset Password</h2>

        <form method="post" action="{% url 'password_reset' %}">
            {% csrf_token %}

            <div class="form-group">
                <label for="id_email">Enter your email</label>
                <!-- Assuming you're using Django's built-in password reset form -->
                <input type="email" name="email" id="id_email" class="form-control" required>
            </div>

            <button type="submit" class="modal-submit-btn">Send Reset Link</button>
        </form>

    </div>
</div>
<script>

  document.addEventListener('DOMContentLoaded', () => {
    // Get the elements
    const openTrigger = document.getElementById('forgot-password-trigger');
    const modalOverlay = document.getElementById('reset-password-modal-overlay');
    const closeBtn = document.getElementById('modal-close-btn');

    // Make sure all elements exist before adding listeners
    if (openTrigger && modalOverlay && closeBtn) {

        // Function to open the modal
        const openModal = (event) => {
            event.preventDefault(); // Stop the link from navigating
            modalOverlay.classList.add('active');
        };

        // Function to close the modal
        const closeModal = () => {
            modalOverlay.classList.remove('active');
        };

        // Add event listeners
        openTrigger.addEventListener('click', openModal);
        closeBtn.addEventListener('click', closeModal);

        // Also close the modal if the user clicks on the dark overlay
        modalOverlay.addEventListener('click', (event) => {
            // Only close if the click is on the overlay itself, not the content
            if (event.target === modalOverlay) {
                closeModal();
            }
        });
    }
});
</script>

{% endblock %}